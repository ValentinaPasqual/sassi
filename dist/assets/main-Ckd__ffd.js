import"./modulepreload-polyfill-B5Qt9EMX.js";import{i as v}from"./initMap-MWMoLte2.js";import{l as E,p as b}from"./dataParser-Cokl2joG.js";function N(t){const e=document.querySelector('[data-content="project-title"]');e&&(e.textContent=t.project.projectTitle);const n=document.querySelector('[data-content="project-subtitle"]');n&&(n.textContent=t.project.projectSubtitle);const l=document.querySelector('[data-content="map-info-title"]');l&&(l.textContent=t.project.mapInfoTitle);const a=document.querySelector('[data-content="map-info-description"]');a&&(a.textContent=t.project.mapInfoDescription);const r=document.querySelector('[data-content="project-thumbnail"]');if(r&&t.project.projectThumbnailURL){let c=r.querySelector("img");if(c)c.src=t.project.projectThumbnailURL,c.alt=t.project.projectShortTitle||"Logo del progetto";else{r.innerHTML="";const s=document.createElement("img");s.src=t.project.projectThumbnailURL,s.alt=t.project.projectShortTitle||"Logo del progetto",s.className="h-20 object-contain",r.appendChild(s)}}else if(r&&!t.project.projectThumbnailURL){const c=r.querySelector("img");c&&c.remove()}const i=document.querySelector('[data-content="project-name"]');if(i){let c=null;for(let s=0;s<i.childNodes.length;s++)i.childNodes[s].nodeType===Node.TEXT_NODE&&(c=i.childNodes[s]);c&&(c.textContent="Il "+t.project.projectName)}const o=t.project.projectDescription.split("<br><br>"),m=document.querySelector('[data-content="project-description-1"]'),d=document.querySelector('[data-content="project-description-2"]');m&&o.length>0&&(m.textContent=o[0]),d&&o.length>1&&(d.textContent=o[1]),console.log("Contenuti aggiornati con successo")}async function j(t,e){try{const n="map";let l=document.getElementById(n);t.map||(console.warn("Configurazione della mappa mancante, utilizzo configurazione predefinita"),t.map={initialView:[45.9763,7.6586],initialZoom:8,tileLayer:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),t.map.containerId=n,console.log(`Inizializzazione mappa con container ID: "${n}"`);const a=v(t),r=a.map,i=a.markers,o=a.renderMarkers;e&&Array.isArray(e)?(console.log(`Aggiunti ${e.length} punti alla mappa`),o&&typeof o=="function"?o(e):console.warn("La funzione renderMarkers non è disponibile"),window.alpinismData=e):console.warn("Nessun dato valido trovato o formato dati non valido"),console.log("Mappa inizializzata con successo")}catch(n){console.error("Errore durante l'inizializzazione della mappa:",n);const l=document.querySelector(".map-container")||document.body,a=document.createElement("div");a.className="error-message p-4 bg-red-100 text-red-700 border border-red-300 rounded",a.textContent="Si è verificato un errore durante il caricamento della mappa. Ricarica la pagina per riprovare.",l.appendChild(a)}}function y(t){const e=t.filter(r=>r.in_evidence===!0);if(e.length===0)return null;const n=document.createElement("div");n.className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12";const l=document.createElement("h2");l.className="text-3xl font-bold text-gray-900 mb-8",l.textContent="Luoghi d'interesse",n.appendChild(l);const a=document.createElement("div");return a.className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",n.appendChild(a),e.forEach(r=>{const i=document.createElement("div");i.className="bg-white rounded-lg overflow-hidden shadow-lg border border-gray-200 card-hover transition duration-300";const o=document.createElement("div");o.className="h-48 overflow-hidden";const m=document.createElement("div");m.className="p-6";const d=document.createElement("div");d.className="flex justify-between items-center mb-2";const c=document.createElement("h3");c.className="text-xl font-bold",c.textContent=r.Name||"Luogo senza nome";const s=document.createElement("span");s.className="text-sm bg-indigo-100 text-indigo-800 px-2 py-1 rounded",s.textContent=r.Date||"",d.appendChild(c),r.Date&&d.appendChild(s),m.appendChild(d);const h=document.createElement("p");h.className="text-gray-600 mb-4",h.textContent=r.in_evidence_description||"",m.appendChild(h);const u=document.createElement("a");u.href=`#${r.id||""}`,u.className="text-indigo-600 font-medium hover:text-indigo-800 inline-flex items-center",m.appendChild(u),i.appendChild(m),a.appendChild(i)}),n}async function z(t){try{const e=document.getElementById("featured-locations-container");if(e){const n=y(t);n?(e.appendChild(n),console.log('Sezione "In evidenza sulla mappa" generata con successo')):console.log("Nessun elemento in evidenza trovato nei dati")}else{console.warn("Container per le località in evidenza non trovato (ID: featured-locations-container)");const n=document.querySelector(".map-container");if(n){const l=document.createElement("div");l.id="featured-locations-container",n.parentNode.insertBefore(l,n.nextSibling);const a=y(t);a&&(l.appendChild(a),console.log('Sezione "In evidenza sulla mappa" generata e inserita automaticamente'))}}}catch(e){console.error("Errore durante l'inizializzazione delle località in evidenza:",e)}}function w(t){const e={};t.forEach(i=>{if(i.storytelling_path&&typeof i.storytelling_path=="string"){const o=i.storytelling_path;e[o]||(e[o]=[]),e[o].push(i)}});const n=Object.keys(e);if(n.length===0)return null;const l=document.createElement("div");l.className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12";const a=document.createElement("h2");a.className="text-3xl font-bold text-gray-900 mb-8",a.textContent="Percorsi narrativi",l.appendChild(a);const r=document.createElement("div");return r.className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",l.appendChild(r),n.forEach(i=>{const o=e[i],m=document.createElement("div");if(m.className="bg-white rounded-lg overflow-hidden shadow-lg border border-gray-200 card-hover transition duration-300",o[0].image_url){const p=document.createElement("div");p.className="h-48 overflow-hidden";const g=document.createElement("img");g.src=o[0].image_url,g.alt=i,g.className="w-full h-full object-cover",p.appendChild(g),m.appendChild(p)}const d=document.createElement("div");d.className="p-6";const c=document.createElement("div");c.className="flex justify-between items-center mb-2";const s=document.createElement("h3");s.className="text-xl font-bold",s.textContent=i;const h=document.createElement("span");if(h.className="text-sm bg-indigo-100 text-indigo-800 px-2 py-1 rounded",h.textContent=`${o.length} elementi`,c.appendChild(s),c.appendChild(h),d.appendChild(c),o[0].storytelling_path_description){const p=document.createElement("p");p.className="text-gray-600 mb-4",p.textContent=o[0].storytelling_path_description,d.appendChild(p)}const u=document.createElement("div");u.className="mt-4 mb-4";const C=document.createElement("h4");C.className="text-sm font-medium text-gray-700 mb-2",C.textContent="Elementi inclusi:",u.appendChild(C);const x=document.createElement("ul");if(x.className="text-sm text-gray-600 pl-5 list-disc",o.slice(0,10).forEach(p=>{const g=document.createElement("li");g.textContent=p.Name||"Elemento senza nome",x.appendChild(g)}),o.length>10){const p=document.createElement("li");p.className="italic",p.textContent=`e altri ${o.length-10} elementi...`,x.appendChild(p)}u.appendChild(x),d.appendChild(u);const f=document.createElement("a");f.href=`pages/narrative.html?percorso=${encodeURIComponent(i)}`,f.rel="noopener noreferrer",f.className="text-indigo-600 font-medium hover:text-indigo-800 inline-flex items-center explore-path-button",f.textContent="Esplora percorso",d.appendChild(f),m.appendChild(d),r.appendChild(m)}),l}async function S(t){try{const e=document.getElementById("storytelling-paths-container");if(e){const n=w(t);n?(e.appendChild(n),console.log('Sezione "Percorsi narrativi" generata con successo')):console.log("Nessun percorso narrativo trovato nei dati")}else console.warn("Container per i percorsi narrativi non trovato (ID: storytelling-paths-container)")}catch(e){console.error("Errore durante l'inizializzazione dei percorsi narrativi:",e)}}document.addEventListener("DOMContentLoaded",async()=>{const t=await E(),e=await b();j(t,e),N(t),z(e),S(e)});
